%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User input Start
coor = [...
    0 0
    2 0
    2 1
    0 1];

BC_T = {...
    'x', 0, 'u', 0
    'y', 0, 'v', 0
    'x', 2, 'u', 0.1};

FORCE_Tx = {'x', 0, 'u', 0};

NR_tol = 1e-10;%1e-11;
max_iter = 100;%20
n_steps = 1;
eltype = 'Q4';
plot = 0;


[~, ~, nen, ngp, ~, numel, ndm] = generateMesh(eltype, coor, plot, 3, 3, 1);

nodes = [...
   0	0
0.666666666666667	0
1.33333333333333	0
2	0
0	0.333333333333333
0.666666666666667	0.333333333333333
1.33333333333333	0.333333333333333
2	0.333333333333333
0	0.666666666666667
0.666666666666667	0.666666666666667
1.33333333333333	0.666666666666667
2	0.666666666666667
0	1
0.666666666666667	1
1.33333333333333	1
2	1
1.33333333333333	0
0	0.333333333333333
0.666666666666667	0.333333333333333
0.666666666666667	0.333333333333333
1.33333333333333	0.333333333333333
1.33333333333333	0.333333333333333
2	0.333333333333333
0.666666666666667	0.666666666666667
1.33333333333333	0.666666666666667
1.33333333333333	1];
elements = [...
1	2	6	5  1	
2	3	7	6	1
17	4	8	21	1
18	19	24	9	1
20	22	25	10	1
22	23	12	25	1
9	24	14	13 1
24	11	15	14 1
25	12	16	26 1
8	21	17	4	2
22	23	12	25 2
19	24	9	18	2
10	20	22	25 2
24	11	15	14	2
25	10	20	22 2
11	15	14	24 2
26	25	12	16 2
7	6	2	3	2
20	22	25	10 2
6	5	1	2	2
18	19	24	9  2
3	7	6	2	2
21	17	4	8  2];
   
numnp  = 26;
nel = 16;
[BC, FORCE] = generateBC(BC_T, FORCE_Tx, nodes, elements, eltype, ndm, numnp, nel);



nummat = 1;
material = [...
   1
   8];
props = {...
   {'E', 190e3; 'nu', 0.3}
   {'L', 1; 'R', 1}};

ndof = 2;
numeq = ndof*numnp;
