%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User input Start

BC_T = {...
   'x', 0, 'u', 0
   'y', 0, 'v', 0
   'z', 0, 'w', 0};
P = 40;
FORCE_Tx = {...
   'node', 20, 'u', P
   'node', 22, 'u', P
   'node', 24, 'u', P
   'node', 26, 'u', P
   };

NR_tol = 1e-10;%1e-11;
max_iter = 100;%20
n_steps = 4;
eltype = 'Q8';
ndm = 3;
ngp = 8;
nen = 8;
plot = 0;

nodes = [...
   0  0     0
   1  0     0
   0  1/2   0
   1  1/2   0
   0  1     0
   1  1     0
   0  0     1/2
   1  0     1/2
   0  1/2   1/2
   1  1/2   1/2
   0  1     1/2
   1  1     1/2
   0  0     1
   1  0     1
   0  1/2   1
   1  1/2   1
   0  1     1
   1  1     1
   1  0     0
   2  0     0
   1  1     0
   2  1     0
   1  0     1
   2  0     1
   1  1     1
   2  1     1];

elements = [...
   1  2  4  3  7  8  10 9  0  0  0  0  0  0  0  0  1
   3  4  6  5  9  10 12 11 0  0  0  0  0  0  0  0  1
   7  8  10 9  13 14 16 15 0  0  0  0  0  0  0  0  1
   9  10 12 11 15 16 18 17 0  0  0  0  0  0  0  0  1
   19 20 22 21 23 24 26 25 0  0  0  0  0  0  0  0  2
   2	8	10	4	1	7	9	3  19 21	25	23	20	22	26	24 3
   4	10	12	6	3	9	11	5  19 21	25	23	20	22	26	24 3
   8	14	16	10	7	13	15	9  19 21	25	23	20	22	26	24 3
   10	16	18	12	9	15	17	11 19 21	25	23	20	22	26	24 3];

numnp  = size(nodes,1);
numel = 5;
[BC, FORCE] = generateBC(BC_T, FORCE_Tx, nodes, elements, eltype, ndm, numnp, numel);
% PlotMesh('Q8', nodes, elements(1:numel,1:nen), 8, numel)
material = [...
   3
   3
   9];
props = {...
   {'E', 100; 'nu', 0.25}
   {'E', 100; 'nu', 0.25}
   {'L', 2; 'R', 1}};

ndof = 3;
numeq = ndof*numnp;
