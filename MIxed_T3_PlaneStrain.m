%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User input Start

NR_tol = 1e-10;%1e-11;
max_iter = 100;%20
n_steps = 1;
eltype = 'T3';
plot = true;

nummat = 1;
material = 6; % PlaneStrain
props = {...
    'E', 2.998
    'v', 0.499};

nodes=[...
   0.00000000000000	1.00000000000000
   0.19509032201613	0.98078528040323
   0.38268343236509	0.92387953251129
   0.55557023301960	0.83146961230255
   0.70710678118655	0.70710678118655
   0.83146961230255	0.55557023301960
   0.92387953251129	0.38268343236509
   0.98078528040323	0.19509032201613
   1.00000000000000	0.00000000000000
   0.00000000000000	1.75000000000000
   0.34140806352823	1.71637424070565
   0.66969600663891	1.61678918189475
   0.97224790778430	1.45507182152945
   1.23743686707646	1.23743686707646
   1.45507182152945	0.97224790778430
   1.61678918189475	0.66969600663891
   1.71637424070565	0.34140806352822
   1.75000000000000	0.00000000000000
   0.00000000000000	2.50000000000000
   0.48772580504032	2.45196320100808
   0.95670858091273	2.30969883127822
   1.38892558254901	2.07867403075636
   1.76776695296637	1.76776695296637
   2.07867403075636	1.38892558254901
   2.30969883127822	0.95670858091272
   2.45196320100808	0.48772580504032
   2.50000000000000	0.00000000000000
   0.00000000000000	3.25000000000000
   0.63404354655242	3.18755216131050
   1.24372115518654	3.00260848066168
   1.80560325731371	2.70227623998327
   2.29809703885628	2.29809703885628
   2.70227623998327	1.80560325731371
   3.00260848066168	1.24372115518654
   3.18755216131050	0.63404354655242
   3.25000000000000	0.00000000000000
   0.00000000000000	4.00000000000000
   0.78036128806451	3.92314112161292
   1.53073372946036	3.69551813004515
   2.22228093207841	3.32587844921018
   2.82842712474619	2.82842712474619
   3.32587844921018	2.22228093207841
   3.69551813004515	1.53073372946036
   3.92314112161292	0.78036128806451
   4.00000000000000	0.00000000000000
   ];

elements=[...
    1    2	10 1
    11   10	2	1
    2 	3	11	1
    12 	11	3  1
    3    4  12 1
    13   12 4  1
    4    5  13 1
    14   13 5  1
    5    6  14 1
    15   14 6  1
    6    7  15 1
    16   15 7  1
    7    8  16 1
    17   16 8  1
    8    9  17 1
    18   17 9  1
    10   11 19 1
    20   19 11 1  
    11   12 20 1
    21   20 12 1
    12   13 21 1
    22   21 13 1
    13   14 22 1
    23   22 14 1
    14   15 23 1
    24   23 15 1
    15   16 24 1
    25   24 16 1
    16   17 25 1
    26   25 17 1
    17   18 26 1
    27   26 18 1
    19   20 28 1
    29   28 20 1
    20   21 29 1
    30   29 21 1
    21   22 30 1
    31   30 22 1
    22   23 31 1
    32   31 23 1
    23   24 32 1
    33   32 24 1
    24   25 33 1
    34   33 25 1
    25   26 34 1
    35   34 26 1
    26   27 35 1
    36   35 27 1     
    28   29 37 1
    38   37 29 1
    29   30 38 1
    39   38 30 1
    30   31 39 1
    40   39 31 1
    31   32 40 1
    41   40 32 1
    32   33 41 1
    42   41 33 1
    33   34 42 1
    43   42 34 1
    34   35 43 1
    44   43 35 1
    35   36 44 1
    45   44 36 1];

ndof  =  3;
nen   =  3;
ngp   =  1;
numnp = 45;
numel = 64;
ndm   =  2;
numeq = ndm*numnp+numel;
BC=[...
    1    1  0.0 1
    10   1  0.0 2
    19   1  0.0 3
    28   1  0.0 4
    37   1  0.0 5
    9    2  0.0 6
    18   2  0.0 7
    27   2  0.0 8
    36   2  0.0 9
    45   2  0.0 10];

FORCE=[...
   1 1 0.000000000000000 1
   2 1 0.038244390945609 2
   3 1 0.075019071405904 3
   4 1 0.108910811017629 4
   5 1 0.138617169239834 5
   6 1 0.162996547385556 6
   7 1 0.181112059624768 7
   8 1 0.192267536981413 8
   9 1 0.098017140358370 9
   1 2 0.098017140329561 10
   2 2 0.192267536953158 11
   3 2 0.181112059624768 12
   4 2 0.162996547385556 13
   5 2 0.138617169239834 14
   6 2 0.108910811017629 15
   7 2 0.075019071405904 16
   8 2 0.038244390951229 17
   9 2 0.000000000000000 18];
if plot
    figure('Position',[100,50,1200,700]);
    patch(...
        reshape(nodes(elements(:,1:nen)',1),nen,numel),...
        reshape(nodes(elements(:,1:nen)',2),nen,numel),'r',...
        'FaceColor','none','EdgeColor','r', 'Marker', 'o', 'MarkerFaceColor', 'r');
    axis equal
    hold on
    
    
    for i=1:numel
        text(mean([nodes(elements(i,1),1),nodes(elements(i,2),1)]),...
            mean([nodes(elements(i,2),2),nodes(elements(i,3),2)]),num2str(i));
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User input End

%     options for props (substitute what's inside < > with a numeric value):
%     material 1:
%     props = {'E',<young's modulus>
%              'v',<poisson's ratio>}

%     material 2:
%     props = {'E',<young's modulus>
%              'v',<poisson's ratio>}

%     material 3:
%     props = {'mu'     ,  <mu's value>
%              'lambda' ,  <lambda's value>};
